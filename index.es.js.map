{"version":3,"file":"index.es.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nclass ParticleLaunch extends karas.Component {\n  constructor(props) {\n    super(props);\n    this.count = 0;\n    this.time = 0;\n    this.playbackRate = props.playbackRate || 1;\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentDidMount() {\n    let { props } = this;\n    let { list = [], num = 0, initNum = 0, interval = 300, intervalNum = 1, delay = 0, autoPlay } = props;\n    if(num === 'infinity' || num === 'Infinity') {\n      num = Infinity;\n    }\n    let dataList = [];\n    let i = 0, length = list.length, first = true;\n    let playCount = 0, count = 0;\n    let fake = this.ref.fake;\n    let cb = this.cb = diff => {\n      diff *= this.playbackRate;\n      if(delay > 0) {\n        delay -= diff;\n      }\n      if(delay <= 0) {\n        diff += delay;\n        this.time += diff;\n        delay = 0;\n        // 如果有初始例子\n        while(initNum-- > 0) {\n          i++;\n          i %= length;\n          count++;\n          dataList.push(this.genItem(list[i]));\n        }\n        // 已有的每个粒子时间增加计算位置，结束的则消失\n        for(let j = dataList.length - 1; j >= 0; j--) {\n          let item = dataList[j];\n          item.time += diff;\n          if(item.time >= item.duration) {\n            dataList.splice(j, 1);\n          }\n          else {\n            let { x, y, width, height, dx, dy, time, duration, easing } = item;\n            let percent = time / duration;\n            if(easing) {\n              percent = easing(percent);\n            }\n            item.nowX = x + dx * percent - width * 0.5;\n            item.nowY = y + dy * percent - height * 0.5;\n          }\n        }\n        if(count >= num) {\n          return;\n        }\n        if(this.animation.playCount > playCount) {\n          let n = this.animation.playCount - playCount;\n          playCount = this.animation.playCount;\n          outer:\n          while(n--) {\n            for(let j = 0; j < intervalNum; j++) {\n              i++;\n              i %= length;\n              count++;\n              dataList.push(this.genItem(list[i]))\n              if(count >= num) {\n                break outer;\n              }\n            }\n          }\n        }\n      }\n    };\n    if(autoPlay !== false) {\n      fake.frameAnimate(cb);\n    }\n    let a = this.animation = fake.animate([\n      {\n        opacity: 1,\n      },\n      {\n        opacity: 0,\n      }\n    ], {\n      duration: 1000,\n      delay,\n      iterations: Infinity,\n      autoPlay,\n    });\n    fake.render = (renderMode, lv, ctx, cache, dx = 0, dy = 0) => {\n      let { sx, sy } = fake;\n      let alpha = ctx.globalAlpha;\n      let time = a.currentTime - delay;\n      if(time < 0) {\n        return;\n      }\n      dataList.forEach(item => {\n        if(item.source) {\n          let blink = item.blink;\n          let opacity = alpha;\n          if(blink) {\n            let num = Math.floor(time / blink.duration);\n            let diff = time % blink.duration;\n            // 偶数from2to，奇数to2from\n            if(num % 2 === 0) {\n              opacity *= blink.from + (blink.to - blink.from) * diff / blink.duration;\n            }\n            else {\n              opacity *= blink.to - (blink.to - blink.from) * diff / blink.duration;\n            }\n          }\n          ctx.globalAlpha = opacity;\n          ctx.drawImage(item.source, item.nowX + sx + dx, item.nowY + sy + dy, item.width, item.height);\n        }\n      });\n      ctx.globalAlpha = alpha;\n    };\n  }\n\n  genItem(item) {\n    let { width, height } = this;\n    let o = {\n      time: 0,\n    };\n    if(Array.isArray(item.x)) {\n      o.x = (item.x[0] + Math.random() * (item.x[1] - item.x[0])) * width;\n    }\n    else {\n      o.x = item.x * width;\n    }\n    if(Array.isArray(item.y)) {\n      o.y = (item.y[0] + Math.random() * (item.y[1] - item.y[0])) * height;\n    }\n    else {\n      o.y = item.y * height;\n    }\n    if(Array.isArray(item.duration)) {\n      o.duration = (item.duration[0] + Math.random() * (item.duration[1] - item.duration[0]));\n    }\n    else {\n      o.duration = item.duration;\n    }\n    if(Array.isArray(item.width)) {\n      o.width = item.width[0] + Math.random() * (item.width[1] - item.width[0]);\n    }\n    else {\n      o.width = item.width;\n    }\n    if(item.ar) {\n      o.height = o.width * item.ar;\n    }\n    else {\n      if(Array.isArray(item.height)) {\n        o.height = item.height[0] + Math.random() * (item.height[1] - item.height[0]);\n      }\n      else {\n        o.height = item.height;\n      }\n    }\n    let deg = 0;\n    if(Array.isArray(item.deg)) {\n      deg = (item.deg[0] + Math.random() * (item.deg[1] - item.deg[0]));\n    }\n    else if(deg) {\n      deg = item.deg;\n    }\n    let distance = 0;\n    if(Array.isArray(item.distance)) {\n      distance = (item.distance[0] + Math.random() * (item.distance[1] - item.distance[0])) * width;\n    }\n    else if(distance) {\n      distance = item.distance * width;\n    }\n    if(deg >= 270) {\n      deg = 360 - deg;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 180) {\n      deg = deg - 180;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 90) {\n      deg = 180 - deg;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    else {\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    o.dx = o.tx - o.x;\n    o.dy = o.ty - o.y;\n    if(item.blink) {\n      let { from = 0, to = 1, duration } = item.blink;\n      if(Array.isArray(duration)) {\n        duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n      }\n      if(Array.isArray(from) && Array.isArray(to)) {\n        o.blink = {\n          from: from[0] + (Math.random() * from[1] - from[0]),\n          to: to[0] + (Math.random() * to[1] - to[0]),\n          duration,\n        };\n      }\n      else {\n        o.blink = {\n          from: from,\n          to: to,\n          duration,\n        };\n      }\n    }\n    if(item.blink) {\n      let { from, to, duration } = item.blink;\n      if(Array.isArray(duration)) {\n        duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n      }\n      if(Array.isArray(from)) {\n        from = from[0] + Math.random() * (from[1] - from[0]);\n      }\n      if(Array.isArray(to)) {\n        to = to[0] + Math.random() * (to[1] - to[0]);\n      }\n      o.blink = {\n        from,\n        to,\n        duration,\n      };\n    }\n    if(item.easing) {\n      item.easing = karas.animate.easing.getEasing(item.easing);\n    }\n    if(item.url) {\n      karas.inject.measureImg(item.url, function(res) {\n        if(res.success) {\n          o.source = res.source;\n        }\n      });\n    }\n    return o;\n  }\n\n  pause() {\n    this.ref.fake.removeFrameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.pause();\n    }\n  }\n\n  resume() {\n    this.ref.fake.frameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.resume();\n    }\n  }\n\n  play() {\n    this.count = 0;\n    this.time = 0;\n    this.ref.fake.removeFrameAnimate(this.cb);\n    this.ref.fake.frameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.play();\n    }\n  }\n\n  render() {\n    return <div>\n      <$polyline ref=\"fake\"/>\n    </div>;\n  }\n}\n\nParticleLaunch.version = version;\n\nexport default ParticleLaunch;\n"],"names":["ParticleLaunch","props","count","time","playbackRate","list","num","initNum","interval","intervalNum","delay","autoPlay","Infinity","dataList","i","length","playCount","fake","ref","cb","diff","push","genItem","j","item","duration","splice","x","y","width","height","dx","dy","easing","percent","nowX","nowY","animation","n","outer","frameAnimate","a","animate","opacity","iterations","render","renderMode","lv","ctx","cache","sx","sy","alpha","globalAlpha","currentTime","forEach","source","blink","Math","floor","from","to","drawImage","o","Array","isArray","random","ar","deg","distance","karas","math","geom","d2r","tx","cos","ty","sin","getEasing","url","inject","measureImg","res","success","removeFrameAnimate","pause","resume","play","Component","version"],"mappings":"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"}