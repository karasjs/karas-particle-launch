{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nconst {\n  enums: {\n    STYLE_KEY: {\n      DISPLAY,\n      VISIBILITY,\n      OPACITY,\n    },\n    NODE_KEY: {\n      NODE_REFRESH_LV,\n    },\n  },\n  refresh: {\n    level: {\n      REPAINT,\n    },\n    Cache,\n  },\n  util: {\n    isNil,\n  },\n  math: {\n    geom: {\n      d2r,\n    },\n    matrix: {\n      identity,\n      multiply,\n    },\n  },\n  mode: {\n    CANVAS,\n    WEBGL,\n  },\n} = karas;\n\nlet uuid = 0;\n\nclass ParticleLaunch extends karas.Component {\n  constructor(props) {\n    super(props);\n    this.count = 0;\n    this.time = 0;\n    this.playbackRate = props.playbackRate || 1;\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentWillUnmount() {\n    Object.keys(this.hashImg || {}).forEach(k => {\n      this.hashImg[k].release();\n    });\n    this.hashCache = {};\n    this.hashMatrix = {};\n    this.hashImg = {};\n    this.hashOpacity = {};\n  }\n\n  componentDidMount() {\n    let { props } = this;\n    let { list = [], num = 0, initNum = 0, interval = 300, intervalNum = 1, delay = 0, autoPlay } = props;\n    if(num === 'infinity' || num === 'Infinity') {\n      num = Infinity;\n    }\n    let dataList = [];\n    let i = 0, length = list.length;\n    let lastTime = 0, count = 0;\n    let fake = this.ref.fake;\n    let hashCache = this.hashCache = {}, hashMatrix = this.hashMatrix = {}, hashImg = this.hashImg = {}, hashOpacity = this.hashOpacity = {};\n    let cb = this.cb = diff => {\n      diff *= this.playbackRate;\n      if(delay > 0) {\n        delay -= diff;\n      }\n      if(delay <= 0) {\n        diff += delay;\n        this.time += diff;\n        delay = 0;\n        // 如果有初始粒子\n        if(initNum > 0) {\n          lastTime = this.time;\n          while(initNum-- > 0) {\n            i++;\n            i %= length;\n            count++;\n            dataList.push(this.genItem(list[i]));\n          }\n        }\n        // 已有的每个粒子时间增加计算位置，结束的则消失\n        for(let j = dataList.length - 1; j >= 0; j--) {\n          let item = dataList[j];\n          item.time += diff;\n          if(item.time >= item.duration) {\n            dataList.splice(j, 1);\n            delete hashCache[item.id];\n            delete hashMatrix[item.id];\n          }\n          else if(item.source) {\n            let { x, y, width, height, dx, dy, time, duration, easing } = item;\n            let percent = time / duration;\n            if(easing) {\n              percent = easing(percent);\n            }\n            item.nowX = x + dx * percent - width * 0.5;\n            item.nowY = y + dy * percent - height * 0.5;\n            item.loaded = true;\n          }\n        }\n        if(count >= num) {\n          return;\n        }\n        if(this.time >= lastTime + interval) {\n          lastTime = this.time;\n          for(let j = 0; j < intervalNum; j++) {\n            i++;\n            i %= length;\n            count++;\n            dataList.push(this.genItem(list[i]))\n            if(count >= num) {\n              break;\n            }\n          }\n        }\n      }\n    };\n    if(autoPlay !== false) {\n      fake.frameAnimate(cb);\n    }\n    let a = this.animation = fake.animate([\n      {\n        opacity: 1,\n      },\n      {\n        opacity: 0,\n      }\n    ], {\n      duration: 1000,\n      delay,\n      iterations: Infinity,\n      autoPlay,\n    });\n    let __config = fake.__config;\n    __config[NODE_REFRESH_LV] = REPAINT;\n    let shadowRoot = this.shadowRoot;\n    let texCache = this.root.texCache;\n    fake.render = (renderMode, lv, ctx, cache, dx = 0, dy = 0) => {\n      let time = a.currentTime - delay;\n      if(time < 0) {\n        return;\n      }\n      __config[NODE_REFRESH_LV] = REPAINT;\n      let computedStyle = shadowRoot.computedStyle;\n      if(computedStyle[DISPLAY] === 'none'\n        || computedStyle[VISIBILITY] === 'hidden'\n        || computedStyle[OPACITY] <= 0) {\n        return;\n      }\n      let { sx, sy } = fake;\n      let globalAlpha;\n      if(renderMode === CANVAS) {\n        globalAlpha = ctx.globalAlpha;\n      }\n      else if(renderMode === WEBGL) {\n        globalAlpha = computedStyle[OPACITY];\n      }\n      dataList.forEach(item => {\n        if(item.loaded) {\n          let blink = item.blink;\n          let opacity = globalAlpha;\n          if(blink) {\n            let num = Math.floor(time / blink.duration);\n            let diff = time % blink.duration;\n            // 偶数from2to，奇数to2from\n            if(num % 2 === 0) {\n              opacity *= blink.from + (blink.to - blink.from) * diff / blink.duration;\n            }\n            else {\n              opacity *= blink.to - (blink.to - blink.from) * diff / blink.duration;\n            }\n          }\n          let x = item.nowX + sx + dx;\n          let y = item.nowY + sy + dy;\n          let m = this.matrixEvent;\n          let tfo = [x, y];\n          m = multiply([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, tfo[0], tfo[1], 0, 1], m);\n          if(item.rotate) {\n            let r = d2r(item.deg);\n            let t = identity();\n            let sin = Math.sin(r);\n            let cos = Math.cos(r);\n            t[0] = t[5] = cos;\n            t[1] = sin;\n            t[4] = -sin;\n            m = multiply(m, t);\n          }\n          if(renderMode === WEBGL) {\n            let cache = hashCache[item.id];\n            if(!cache) {\n              let url = item.url;\n              if(!hashImg[url]) {\n                cache = hashCache[item.id] = Cache.getInstance(\n                  [x - 1, y - 1, x + item.sourceWidth + 1, y + item.sourceHeight + 1],\n                  x, y\n                );\n                cache.ctx.drawImage(item.source, x + cache.dx, y + cache.dy)\n                hashImg[url] = cache;\n              }\n              else {\n                let c = hashImg[url];\n                cache = hashCache[item.id] = new karas.refresh.Cache(\n                  c.width, c.height,\n                  [x - 1, y - 1, x + item.sourceWidth + 1, y + item.sourceHeight + 1],\n                  c.page, c.pos, x, y\n                );\n              }\n            }\n            else {\n              cache.__bbox = [x - 1, y - 1, x + item.sourceWidth + 1, y + item.sourceHeight + 1];\n              cache.__sx = x;\n              cache.__sy = y;\n            }\n            if(item.width !== item.sourceWidth && item.height !== item.sourceHeight) {\n              let t2 = identity();\n              t2[0] = item.width / item.sourceWidth;\n              t2[5] = item.height / item.sourceHeight;\n              m = multiply(m, t2);\n            }\n            m = multiply(m, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, -tfo[0], -tfo[1], 0, 1]);\n            // console.log(x,y,opacity,m);\n            hashMatrix[item.id] = m;\n            hashOpacity[item.id] = opacity;\n          }\n          else if(renderMode === CANVAS) {\n            ctx.globalAlpha = opacity;\n            m = multiply(m, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, -tfo[0], -tfo[1], 0, 1]);\n            ctx.setTransform(m[0], m[1], m[4], m[5], m[12], m[13]);\n            ctx.drawImage(item.source, x, y, item.width, item.height);\n          }\n        }\n      });\n      if(renderMode === CANVAS) {\n        ctx.globalAlpha = globalAlpha;\n      }\n    };\n    fake.__hookGlRender = function(gl, opacity, cx, cy, dx, dy, revertY) {\n      let computedStyle = shadowRoot.computedStyle;\n      if(computedStyle[DISPLAY] === 'none'\n        || computedStyle[VISIBILITY] === 'hidden'\n        || computedStyle[OPACITY] <= 0) {\n        return;\n      }\n      dataList.forEach(item => {\n        if(item.loaded) {\n          texCache.addTexAndDrawWhenLimit(gl, hashCache[item.id], hashOpacity[item.id], hashMatrix[item.id], cx, cy, dx, dy, revertY);\n        }\n      });\n    };\n  }\n\n  genItem(item) {\n    let { width, height } = this;\n    let o = {\n      id: uuid++,\n      time: 0,\n      url: item.url,\n    };\n    if(Array.isArray(item.x)) {\n      o.x = (item.x[0] + Math.random() * (item.x[1] - item.x[0])) * width;\n    }\n    else {\n      o.x = item.x * width;\n    }\n    if(Array.isArray(item.y)) {\n      o.y = (item.y[0] + Math.random() * (item.y[1] - item.y[0])) * height;\n    }\n    else {\n      o.y = item.y * height;\n    }\n    if(Array.isArray(item.duration)) {\n      o.duration = (item.duration[0] + Math.random() * (item.duration[1] - item.duration[0]));\n    }\n    else {\n      o.duration = item.duration;\n    }\n    if(Array.isArray(item.width)) {\n      o.width = item.width[0] + Math.random() * (item.width[1] - item.width[0]);\n    }\n    else if(!isNil(item.width)) {\n      o.width = item.width;\n    }\n    if(Array.isArray(item.height)) {\n      o.height = item.height[0] + Math.random() * (item.height[1] - item.height[0]);\n    }\n    else if(!isNil(item.height)) {\n      o.height = item.height;\n    }\n    let deg = 0;\n    if(Array.isArray(item.deg)) {\n      deg = (item.deg[0] + Math.random() * (item.deg[1] - item.deg[0]));\n    }\n    else if(deg) {\n      deg = item.deg;\n    }\n    o.deg = deg;\n    if(item.rotate === true) {\n      o.rotate = true;\n    }\n    let distance = 0;\n    if(Array.isArray(item.distance)) {\n      distance = (item.distance[0] + Math.random() * (item.distance[1] - item.distance[0])) * width;\n    }\n    else if(distance) {\n      distance = item.distance * width;\n    }\n    if(deg >= 270) {\n      deg = 360 - deg;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 180) {\n      deg = deg - 180;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 90) {\n      deg = 180 - deg;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    else {\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    o.dx = o.tx - o.x;\n    o.dy = o.ty - o.y;\n    if(item.blink) {\n      let { from = 0, to = 1, duration } = item.blink;\n      if(Array.isArray(duration)) {\n        duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n      }\n      if(Array.isArray(from) && Array.isArray(to)) {\n        o.blink = {\n          from: from[0] + (Math.random() * from[1] - from[0]),\n          to: to[0] + (Math.random() * to[1] - to[0]),\n          duration,\n        };\n      }\n      else {\n        o.blink = {\n          from: from,\n          to: to,\n          duration,\n        };\n      }\n    }\n    if(item.blink) {\n      let { from, to, duration } = item.blink;\n      if(Array.isArray(duration)) {\n        duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n      }\n      if(Array.isArray(from)) {\n        from = from[0] + Math.random() * (from[1] - from[0]);\n      }\n      if(Array.isArray(to)) {\n        to = to[0] + Math.random() * (to[1] - to[0]);\n      }\n      o.blink = {\n        from,\n        to,\n        duration,\n      };\n    }\n    if(item.easing) {\n      o.easing = karas.animate.easing.getEasing(item.easing);\n    }\n    if(item.url) {\n      karas.inject.measureImg(item.url, function(res) {\n        if(res.success) {\n          o.source = res.source;\n          o.sourceWidth = res.width;\n          o.sourceHeight = res.height;\n          if(!(isNil(o.width) && isNil(o.height))) {\n            if(isNil(o.width)) {\n              o.width = res.width / res.height * o.height;\n            }\n            else if(isNil(o.height)) {\n              o.height = o.width * res.height / res.width;\n            }\n          }\n        }\n      });\n    }\n    return o;\n  }\n\n  pause() {\n    this.ref.fake.removeFrameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.pause();\n    }\n  }\n\n  resume() {\n    this.ref.fake.frameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.resume();\n    }\n  }\n\n  play() {\n    this.count = 0;\n    this.time = 0;\n    this.ref.fake.removeFrameAnimate(this.cb);\n    this.ref.fake.frameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.play();\n    }\n  }\n\n  render() {\n    return <div>\n      <$polyline ref=\"fake\" style={{width:0,visibility:'hidden'}}/>\n    </div>;\n  }\n}\n\nParticleLaunch.version = version;\n\nexport default ParticleLaunch;\n"],"names":["karas","enums","STYLE_KEY","DISPLAY","VISIBILITY","OPACITY","NODE_REFRESH_LV","NODE_KEY","refresh","REPAINT","level","Cache","isNil","util","math","d2r","geom","matrix","identity","multiply","mode","CANVAS","WEBGL","uuid","ParticleLaunch","props","count","time","playbackRate","Object","keys","hashImg","forEach","k","release","hashCache","hashMatrix","hashOpacity","list","num","initNum","interval","intervalNum","delay","autoPlay","Infinity","dataList","i","length","lastTime","fake","ref","cb","diff","push","genItem","j","item","duration","splice","id","source","x","y","width","height","dx","dy","easing","percent","nowX","nowY","loaded","frameAnimate","a","animation","animate","opacity","iterations","__config","shadowRoot","texCache","root","render","renderMode","lv","ctx","cache","currentTime","computedStyle","sx","sy","globalAlpha","blink","Math","floor","from","to","m","matrixEvent","tfo","rotate","r","deg","t","sin","cos","url","getInstance","sourceWidth","sourceHeight","drawImage","c","page","pos","__bbox","__sx","__sy","t2","setTransform","__hookGlRender","gl","cx","cy","revertY","addTexAndDrawWhenLimit","o","Array","isArray","random","distance","tx","ty","getEasing","inject","measureImg","res","success","removeFrameAnimate","pause","resume","play","visibility","Component","version"],"mappings":"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"}