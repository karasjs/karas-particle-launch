{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nconst {\n  enums: {\n    STYLE_KEY: {\n      TRANSFORM_ORIGIN,\n    },\n  },\n  util: {\n    isNil,\n  },\n} = karas;\n\nclass ParticleLaunch extends karas.Component {\n  constructor(props) {\n    super(props);\n    this.count = 0;\n    this.time = 0;\n    this.playbackRate = props.playbackRate || 1;\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentDidMount() {\n    let { props } = this;\n    let { list = [], num = 0, initNum = 0, interval = 300, intervalNum = 1, delay = 0, autoPlay } = props;\n    if(num === 'infinity' || num === 'Infinity') {\n      num = Infinity;\n    }\n    let dataList = [];\n    let i = 0, length = list.length;\n    let lastTime = 0, count = 0;\n    let fake = this.ref.fake;\n    let cb = this.cb = diff => {\n      diff *= this.playbackRate;\n      if(delay > 0) {\n        delay -= diff;\n      }\n      if(delay <= 0) {\n        diff += delay;\n        this.time += diff;\n        delay = 0;\n        // 如果有初始例子\n        if(initNum > 0) {\n          lastTime = this.time;\n          while(initNum-- > 0) {\n            i++;\n            i %= length;\n            count++;\n            dataList.push(this.genItem(list[i]));\n          }\n        }\n        // 已有的每个粒子时间增加计算位置，结束的则消失\n        for(let j = dataList.length - 1; j >= 0; j--) {\n          let item = dataList[j];\n          item.time += diff;\n          if(item.time >= item.duration) {\n            dataList.splice(j, 1);\n          }\n          else {\n            let { x, y, width, height, dx, dy, time, duration, easing } = item;\n            let percent = time / duration;\n            if(easing) {\n              percent = easing(percent);\n            }\n            item.nowX = x + dx * percent - width * 0.5;\n            item.nowY = y + dy * percent - height * 0.5;\n          }\n        }\n        if(count >= num) {\n          return;\n        }\n        if(this.time >= lastTime + interval) {\n          lastTime = this.time;\n          for(let j = 0; j < intervalNum; j++) {\n            i++;\n            i %= length;\n            count++;\n            dataList.push(this.genItem(list[i]))\n            if(count >= num) {\n              break;\n            }\n          }\n        }\n      }\n    };\n    if(autoPlay !== false) {\n      fake.frameAnimate(cb);\n    }\n    let a = this.animation = fake.animate([\n      {\n        opacity: 1,\n      },\n      {\n        opacity: 0,\n      }\n    ], {\n      duration: 1000,\n      delay,\n      iterations: Infinity,\n      autoPlay,\n    });\n    fake.render = (renderMode, lv, ctx, cache, dx = 0, dy = 0) => {\n      let { sx, sy } = fake;\n      let alpha = ctx.globalAlpha;\n      let time = a.currentTime - delay;\n      if(time < 0) {\n        return;\n      }\n      dataList.forEach(item => {\n        if(item.source) {\n          let blink = item.blink;\n          let opacity = alpha;\n          if(blink) {\n            let num = Math.floor(time / blink.duration);\n            let diff = time % blink.duration;\n            // 偶数from2to，奇数to2from\n            if(num % 2 === 0) {\n              opacity *= blink.from + (blink.to - blink.from) * diff / blink.duration;\n            }\n            else {\n              opacity *= blink.to - (blink.to - blink.from) * diff / blink.duration;\n            }\n          }\n          ctx.globalAlpha = opacity;\n          let x = item.nowX + sx + dx;\n          let y = item.nowY + sy + dy;\n          if(item.rotate) {\n            let m = this.matrixEvent;\n            let computedStyle = this.computedStyle;\n            let tfo = computedStyle[TRANSFORM_ORIGIN].slice(0);\n            tfo[0] += x;\n            tfo[1] += y;\n            m = karas.math.matrix.multiply(m, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, 0, 1]);\n            let deg = item.deg;\n            let r = karas.math.geom.d2r(deg);\n            let t = karas.math.matrix.identity();\n            let sin = Math.sin(r);\n            let cos = Math.cos(r);\n            t[0] = t[5] = cos;\n            t[1] = sin;\n            t[4] = -sin;\n            m = karas.math.matrix.multiply(m, t);\n            m = karas.math.matrix.multiply(m, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, -x, -y, 0, 1]);\n            ctx.setTransform(m[0], m[1], m[4], m[5], m[12], m[13]);\n          }\n          ctx.drawImage(item.source, x, y, item.width, item.height);\n        }\n      });\n      ctx.globalAlpha = alpha;\n    };\n  }\n\n  genItem(item) {\n    let { width, height } = this;\n    let o = {\n      time: 0,\n    };\n    if(Array.isArray(item.x)) {\n      o.x = (item.x[0] + Math.random() * (item.x[1] - item.x[0])) * width;\n    }\n    else {\n      o.x = item.x * width;\n    }\n    if(Array.isArray(item.y)) {\n      o.y = (item.y[0] + Math.random() * (item.y[1] - item.y[0])) * height;\n    }\n    else {\n      o.y = item.y * height;\n    }\n    if(Array.isArray(item.duration)) {\n      o.duration = (item.duration[0] + Math.random() * (item.duration[1] - item.duration[0]));\n    }\n    else {\n      o.duration = item.duration;\n    }\n    if(Array.isArray(item.width)) {\n      o.width = item.width[0] + Math.random() * (item.width[1] - item.width[0]);\n    }\n    else if(!isNil(item.width)) {\n      o.width = item.width;\n    }\n    if(Array.isArray(item.height)) {\n      o.height = item.height[0] + Math.random() * (item.height[1] - item.height[0]);\n    }\n    else if(!isNil(item.height)) {\n      o.height = item.height;\n    }\n    let deg = 0;\n    if(Array.isArray(item.deg)) {\n      deg = (item.deg[0] + Math.random() * (item.deg[1] - item.deg[0]));\n    }\n    else if(deg) {\n      deg = item.deg;\n    }\n    o.deg = deg;\n    if(item.rotate === true) {\n      o.rotate = true;\n    }\n    let distance = 0;\n    if(Array.isArray(item.distance)) {\n      distance = (item.distance[0] + Math.random() * (item.distance[1] - item.distance[0])) * width;\n    }\n    else if(distance) {\n      distance = item.distance * width;\n    }\n    if(deg >= 270) {\n      deg = 360 - deg;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 180) {\n      deg = deg - 180;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 90) {\n      deg = 180 - deg;\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    else {\n      deg = karas.math.geom.d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    o.dx = o.tx - o.x;\n    o.dy = o.ty - o.y;\n    if(item.blink) {\n      let { from = 0, to = 1, duration } = item.blink;\n      if(Array.isArray(duration)) {\n        duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n      }\n      if(Array.isArray(from) && Array.isArray(to)) {\n        o.blink = {\n          from: from[0] + (Math.random() * from[1] - from[0]),\n          to: to[0] + (Math.random() * to[1] - to[0]),\n          duration,\n        };\n      }\n      else {\n        o.blink = {\n          from: from,\n          to: to,\n          duration,\n        };\n      }\n    }\n    if(item.blink) {\n      let { from, to, duration } = item.blink;\n      if(Array.isArray(duration)) {\n        duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n      }\n      if(Array.isArray(from)) {\n        from = from[0] + Math.random() * (from[1] - from[0]);\n      }\n      if(Array.isArray(to)) {\n        to = to[0] + Math.random() * (to[1] - to[0]);\n      }\n      o.blink = {\n        from,\n        to,\n        duration,\n      };\n    }\n    if(item.easing) {\n      o.easing = karas.animate.easing.getEasing(item.easing);\n    }\n    if(item.url) {\n      karas.inject.measureImg(item.url, function(res) {\n        if(res.success) {\n          o.source = res.source;\n          if(!(isNil(o.width) && isNil(o.height))) {\n            if(isNil(o.width)) {\n              o.width = res.width / res.height * o.height;\n            }\n            else if(isNil(o.height)) {\n              o.height = o.width * res.height / res.width;\n            }\n          }\n        }\n      });\n    }\n    return o;\n  }\n\n  pause() {\n    this.ref.fake.removeFrameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.pause();\n    }\n  }\n\n  resume() {\n    this.ref.fake.frameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.resume();\n    }\n  }\n\n  play() {\n    this.count = 0;\n    this.time = 0;\n    this.ref.fake.removeFrameAnimate(this.cb);\n    this.ref.fake.frameAnimate(this.cb);\n    if(this.animation) {\n      this.animation.play();\n    }\n  }\n\n  render() {\n    return <div>\n      <$polyline ref=\"fake\"/>\n    </div>;\n  }\n}\n\nParticleLaunch.version = version;\n\nexport default ParticleLaunch;\n"],"names":["TRANSFORM_ORIGIN","karas","enums","STYLE_KEY","isNil","util","ParticleLaunch","props","count","time","playbackRate","list","num","initNum","interval","intervalNum","delay","autoPlay","Infinity","dataList","i","length","lastTime","fake","ref","cb","diff","push","genItem","j","item","duration","splice","x","y","width","height","dx","dy","easing","percent","nowX","nowY","frameAnimate","a","animation","animate","opacity","iterations","render","renderMode","lv","ctx","cache","sx","sy","alpha","globalAlpha","currentTime","forEach","source","blink","Math","floor","from","to","rotate","m","matrixEvent","computedStyle","tfo","slice","math","matrix","multiply","deg","r","geom","d2r","t","identity","sin","cos","setTransform","drawImage","o","Array","isArray","random","distance","tx","ty","getEasing","url","inject","measureImg","res","success","removeFrameAnimate","pause","resume","play","Component","version"],"mappings":"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"}