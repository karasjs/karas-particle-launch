{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nconst {\n  enums: {\n    STYLE_KEY: {\n      DISPLAY,\n      VISIBILITY,\n      OPACITY,\n    },\n  },\n  refresh: {\n    level: {\n      REPAINT,\n    },\n  },\n  util: {\n    isNil,\n    isFunction,\n  },\n  math: {\n    geom: {\n      d2r,\n    },\n    matrix: {\n      identity,\n      multiply,\n    },\n  },\n  mode: {\n    CANVAS,\n    WEBGL,\n  },\n} = karas;\n\nclass $ extends karas.Geom {\n  calContent(currentStyle, computedStyle) {\n    let res = super.calContent(currentStyle, computedStyle);\n    if(res) {\n      return res;\n    }\n    return this.dataList && this.dataList.length;\n  }\n  render(renderMode, ctx, dx, dy) {\n    let res = super.render(renderMode, ctx, dx, dy);\n    let dataList = this.dataList;\n    if(!dataList || !dataList.length) {\n      return res;\n    }\n    let { __x1: x1, __y1: y1, __cache } = this;\n    let globalAlpha = 1;\n    if(renderMode === CANVAS) {\n      globalAlpha = ctx.globalAlpha;\n    }\n    dataList.forEach(item => {\n      if(item.loaded) {\n        let opacity = globalAlpha;\n        opacity *= item.opacity;\n        // 计算位置\n        let x = item.nowX + x1 + dx;\n        let y = item.nowY + y1 + dy;\n        let m = identity();\n        let tfo = [x + item.width * 0.5, y + item.height * 0.5];\n        if(renderMode === CANVAS) {\n          m = multiply([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, tfo[0], tfo[1], 0, 1], m);\n        }\n        // 移动一半使得图形中心为计算位置的原点\n        m = multiply(m, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, -item.width * 0.5, -item.height * 0.5, 0, 1])\n        // 保持方向角度于起点一致性，可以指定angle偏移\n        if(!isNil(item.angle)) {\n          let r = d2r(item.deg + item.angle);\n          let t = identity();\n          let sin = Math.sin(r);\n          let cos = Math.cos(r);\n          t[0] = t[5] = cos;\n          t[1] = sin;\n          t[4] = -sin;\n          m = multiply(m, t);\n        }\n        if(item.sc && item.sc !== 1) {\n          let t = identity();\n          t[0] = t[5] = t[10] = item.sc;\n          m = multiply(m, t);\n        }\n        if(renderMode === CANVAS) {\n          ctx.globalAlpha = opacity;\n          // canvas处理方式不一样，render的dx和dy包含了total的偏移计算考虑，可以无感知\n          m = multiply(m, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, -tfo[0], -tfo[1], 0, 1]);\n          // 父级的m，webgl时有cache不应该包含，暂时解决\n          if(__cache && __cache.available) {\n          }\n          else {\n            let pm = this.matrixEvent;\n            if(pm) {\n              m = multiply(pm, m);\n            }\n          }\n          ctx.setTransform(m[0], m[1], m[4], m[5], m[12], m[13]);\n          ctx.drawImage(item.source, x, y, item.width, item.height);\n        }\n      }\n    });\n    if(renderMode === CANVAS) {\n      ctx.globalAlpha = globalAlpha;\n    }\n  }\n}\n\nlet uuid = 0;\n\nclass ParticleLaunch extends karas.Component {\n  constructor(props) {\n    super(props);\n    this.count = 0;\n    this.time = 0;\n    this.playbackRate = props.playbackRate || 1;\n    this.interval = props.interval || 300;\n    this.intervalNum = props.intervalNum || 1;\n    this.num = props.num || 0;\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentWillUnmount() {\n    Object.keys(this.hashImg || {}).forEach(k => {\n      this.hashImg[k].release();\n    });\n    this.hashCache = {};\n    this.hashMatrix = {};\n    this.hashImg = {};\n  }\n\n  componentDidMount() {\n    let { props, shadowRoot: { computedStyle } } = this;\n    let { list = [], initNum = 0, delay = 0, autoPlay } = props;\n    let dataList = [];\n    let i = 0, length = list.length;\n    let lastTime = 0, count = 0;\n    let fake = this.ref.fake;\n    let hashCache = this.hashCache = {};\n    let hashMatrix = this.hashMatrix = {};\n    let currentTime = 0, maxTime = 0;\n    let hasStart;\n    let self = this;\n    let cb = this.cb = diff => {\n      fake.dataList = null;\n      diff *= this.playbackRate;\n      currentTime += diff;\n      if(delay > 0) {\n        delay -= diff;\n      }\n      if(delay <= 0) {\n        diff += delay;\n        this.time += diff;\n        delay = 0;\n        // 如果有初始粒子\n        if(initNum > 0) {\n          lastTime = this.time;\n          while(initNum-- > 0) {\n            i++;\n            i %= length;\n            count++;\n            let o = this.genItem(list[i]);\n            maxTime = Math.max(maxTime, currentTime + o.duration);\n            dataList.push(o);\n          }\n        }\n        // 已有的每个粒子时间增加计算位置，结束的则消失\n        for(let j = dataList.length - 1; j >= 0; j--) {\n          let item = dataList[j];\n          item.time += diff;\n          if(item.time >= item.duration) {\n            dataList.splice(j, 1);\n            delete hashCache[item.id];\n            delete hashMatrix[item.id];\n          }\n          else if(item.source) {\n            let { x, y, tx, ty, dx, dy, time, duration, easing, blink, fade, scale, direction } = item;\n            let percent = time / duration;\n            if(easing) {\n              percent = easing(percent);\n            }\n            if(direction === 'reverse') {\n              item.nowX = tx - dx * percent;\n              item.nowY = ty - dy * percent;\n            }\n            else {\n              item.nowX = x + dx * percent;\n              item.nowY = y + dy * percent;\n            }\n            let opacity = 1;\n            if(blink) {\n              let num = Math.floor(time / blink.duration);\n              let diff = time % blink.duration;\n              let easing = blink.easing;\n              let percent = (blink.to - blink.from) * diff / blink.duration;\n              if(easing) {\n                let timeFunction = karas.animate.easing.getEasing(easing);\n                if(timeFunction !== karas.animate.easing.linear) {\n                  percent = timeFunction(percent);\n                }\n              }\n              // 偶数from2to，奇数to2from\n              if(num % 2 === 0) {\n                opacity *= blink.from + percent;\n              }\n              else {\n                opacity *= blink.to - percent;\n              }\n            }\n            if(fade) {\n              let p = time / fade.duration;\n              p = Math.max(0, p);\n              p = Math.min(1, p);\n              let easing = fade.easing;\n              if(easing) {\n                let timeFunction = karas.animate.easing.getEasing(easing);\n                if(timeFunction !== karas.animate.easing.linear) {\n                  p = timeFunction(p);\n                }\n              }\n              let alpha = fade.from + (fade.to - fade.from) * p;\n              alpha = Math.max(0, alpha);\n              alpha = Math.min(1, alpha);\n              opacity *= alpha;\n            }\n            item.opacity = opacity;\n            let sc = 1;\n            if(scale) {\n              let p = time / scale.duration;\n              p = Math.max(0, p);\n              p = Math.min(1, p);\n              let easing = scale.easing;\n              if(easing) {\n                let timeFunction = karas.animate.easing.getEasing(easing);\n                if(timeFunction !== karas.animate.easing.linear) {\n                  p = timeFunction(p);\n                }\n              }\n              let s = scale.from + (scale.to - scale.from) * p;\n              sc *= s;\n            }\n            item.sc = sc;\n            item.loaded = true;\n            hasStart = true;\n          }\n        }\n        // 开始后每次都刷新，即便数据已空，要变成空白初始状态\n        if(hasStart && currentTime >= delay) {\n          if(computedStyle[DISPLAY] !== 'none' && computedStyle[VISIBILITY] !== 'hidden' && computedStyle[OPACITY] > 0) {\n            fake.dataList = dataList;\n            fake.refresh(REPAINT);\n            self.emit('frame');\n          }\n        }\n        // 数量完了动画也执行完了停止\n        if(count >= this.num && currentTime >= maxTime) {\n          fake.removeFrameAnimate(cb);\n          return;\n        }\n        // 每隔interval开始生成这一阶段的粒子数据\n        if(this.time >= lastTime + this.interval && count < this.num) {\n          lastTime = this.time;\n          for(let j = 0; j < this.intervalNum; j++) {\n            i++;\n            i %= length;\n            count++;\n            let o = this.genItem(list[i]);\n            maxTime = Math.max(maxTime, currentTime + o.duration);\n            dataList.push(o);\n            if(count >= this.num) {\n              break;\n            }\n          }\n        }\n      }\n    };\n    if(autoPlay !== false) {\n      fake.frameAnimate(cb);\n    }\n  }\n\n  genItem(item) {\n    let { width, height } = this;\n    let o = {\n      id: uuid++,\n      time: 0,\n      url: item.url,\n    };\n    if(Array.isArray(item.x)) {\n      o.x = (item.x[0] + Math.random() * (item.x[1] - item.x[0])) * width;\n    }\n    else {\n      o.x = item.x * width;\n    }\n    if(Array.isArray(item.y)) {\n      o.y = (item.y[0] + Math.random() * (item.y[1] - item.y[0])) * height;\n    }\n    else {\n      o.y = item.y * height;\n    }\n    if(Array.isArray(item.duration)) {\n      o.duration = (item.duration[0] + Math.random() * (item.duration[1] - item.duration[0]));\n    }\n    else {\n      o.duration = item.duration;\n    }\n    if(Array.isArray(item.width)) {\n      o.width = item.width[0] + Math.random() * (item.width[1] - item.width[0]);\n    }\n    else if(!isNil(item.width)) {\n      o.width = item.width;\n    }\n    if(Array.isArray(item.height)) {\n      o.height = item.height[0] + Math.random() * (item.height[1] - item.height[0]);\n    }\n    else if(!isNil(item.height)) {\n      o.height = item.height;\n    }\n    let deg = 0;\n    if(Array.isArray(item.deg)) {\n      deg = (item.deg[0] + Math.random() * (item.deg[1] - item.deg[0]));\n    }\n    else if(item.deg) {\n      deg = item.deg;\n    }\n    o.deg = deg;\n    let angle = parseFloat(item.angle);\n    if(item.angle === true) {\n      angle = 0;\n    }\n    if(!isNaN(angle)) {\n      o.angle = angle;\n    }\n    let distance = 0;\n    if(Array.isArray(item.distance)) {\n      distance = (item.distance[0] + Math.random() * (item.distance[1] - item.distance[0])) * width;\n    }\n    else if(item.distance) {\n      distance = item.distance * width;\n    }\n    o.distance = distance;\n    o.direction = item.direction;\n    let deg2 = deg;\n    if(deg >= 270) {\n      deg = 360 - deg;\n      deg = d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 180) {\n      deg = deg - 180;\n      deg = d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y - distance * Math.sin(deg);\n    }\n    else if(deg >= 90) {\n      deg = 180 - deg;\n      deg = d2r(deg);\n      o.tx = o.x - distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    else {\n      deg = d2r(deg);\n      o.tx = o.x + distance * Math.cos(deg);\n      o.ty = o.y + distance * Math.sin(deg);\n    }\n    o.deg = deg2;\n    o.dx = o.tx - o.x;\n    o.dy = o.ty - o.y;\n    ['blink', 'fade', 'scale'].forEach(k => {\n      if(item[k]) {\n        let { from, to, duration, easing } = item[k];\n        if(Array.isArray(duration)) {\n          duration = duration[0] + Math.random() * (duration[1] - duration[0]);\n        }\n        if(Array.isArray(from)) {\n          from = from[0] + Math.random() * (from[1] - from[0]);\n        }\n        if(Array.isArray(to)) {\n          to = to[0] + Math.random() * (to[1] - to[0]);\n        }\n        o[k] = {\n          from,\n          to,\n          duration,\n          easing,\n        };\n      }\n    });\n    if(item.easing) {\n      o.easing = karas.animate.easing.getEasing(item.easing);\n    }\n    if(item.url) {\n      karas.inject.measureImg(item.url, function(res) {\n        if(res.success) {\n          o.source = res.source;\n          o.sourceWidth = res.width;\n          o.sourceHeight = res.height;\n          if(!(isNil(o.width) && isNil(o.height))) {\n            if(isNil(o.width)) {\n              o.width = res.width / res.height * o.height;\n            }\n            else if(isNil(o.height)) {\n              o.height = o.width * res.height / res.width;\n            }\n          }\n          else {\n            o.width = res.width;\n            o.height = res.height;\n          }\n        }\n      });\n    }\n    return o;\n  }\n\n  pause() {\n    this.ref.fake.removeFrameAnimate(this.cb);\n  }\n\n  resume() {\n    this.ref.fake.frameAnimate(this.cb);\n  }\n\n  play() {\n    this.count = 0;\n    this.time = 0;\n    this.ref.fake.removeFrameAnimate(this.cb);\n    this.ref.fake.frameAnimate(this.cb);\n  }\n\n  get playbackRate() {\n    return this.__playbackRate;\n  }\n\n  set playbackRate(v) {\n    this.__playbackRate = parseFloat(v) || 1;\n  }\n\n  get interval() {\n    return this.__interval;\n  }\n\n  get intervalNum() {\n    return this.__intervalNum;\n  }\n\n  set intervalNum(v) {\n    this.__intervalNum = parseInt(v) || 1;\n  }\n\n  set interval(v) {\n    this.__interval = parseInt(v) || 300;\n  }\n\n  get num() {\n    return this.__num;\n  }\n\n  set num(v) {\n    if(v === Infinity || /infinity/i.test(v)) {\n      this.__num = Infinity;\n    }\n    else {\n      this.__num = parseInt(v) || 0;\n    }\n  }\n\n  render() {\n    return <div cacheAsBitmap={this.props.cacheAsBitmap}>\n      <$ ref=\"fake\" style={{\n        width: '100%',\n        height: '100%',\n      }}/>\n    </div>;\n  }\n}\n\nParticleLaunch.version = version;\n\nexport default ParticleLaunch;\n"],"names":["karas","enums","STYLE_KEY","DISPLAY","VISIBILITY","OPACITY","REPAINT","refresh","level","util","isNil","isFunction","math","d2r","geom","matrix","identity","multiply","mode","CANVAS","WEBGL","$","currentStyle","computedStyle","res","dataList","length","renderMode","ctx","dx","dy","x1","__x1","y1","__y1","__cache","globalAlpha","forEach","item","loaded","opacity","x","nowX","y","nowY","m","tfo","width","height","angle","r","deg","t","sin","Math","cos","sc","available","pm","matrixEvent","setTransform","drawImage","source","Geom","uuid","ParticleLaunch","props","count","time","playbackRate","interval","intervalNum","num","Object","keys","hashImg","k","release","hashCache","hashMatrix","shadowRoot","list","initNum","delay","autoPlay","i","lastTime","fake","ref","currentTime","maxTime","hasStart","self","cb","diff","o","genItem","max","duration","push","j","splice","id","tx","ty","easing","blink","fade","scale","direction","percent","floor","to","from","timeFunction","animate","getEasing","linear","p","min","alpha","s","emit","removeFrameAnimate","frameAnimate","url","Array","isArray","random","parseFloat","isNaN","distance","deg2","inject","measureImg","success","sourceWidth","sourceHeight","__playbackRate","v","__interval","parseInt","__intervalNum","__num","Infinity","test","cacheAsBitmap","Component","version"],"mappings":"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"}